# 예약내역 기능정의서

| Role | 1Depth | 2Depth | 3Depth | 4Depth | 타입 | 화면명 | 화면 ID | PC/MO | spec | 접근 권한 | 기능 설명 | 관련 요구사항ID | 비고 |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 발송관리 | 발송관리 | 예약내역 | - | - | page | 발송관리 > 예약내역 | SEND_2_3_0_0_0_P | 공통 | 1차 | 로그인 | **1. 페이지 개요**<br>- 회원이 예약한 메시지 발송 내역을 조회하고 관리하는 페이지<br>- 예약 발송 취소 및 수정 기능 제공<br>- 문자(SMS/LMS/MMS) 및 카카오톡(알림톡/브랜드톡) 예약내역 통합 조회<br><br>**2. 페이지 안내**<br>- 안내 메시지 표시 영역<br>  ㄴ "최근 90일동안 보낸 메시지를 확인하실 수 있습니다."<br>  ㄴ "문자 메시지는 최대 72시간, 카카오톡 메시지는 최대 24시간까지 진행 중일 수 있습니다."<br>  ㄴ "예약 메시지는 '예약시간 10분 전까지' 수정 및 취소하실 수 있습니다."<br><br>**3. 조회 기간 설정**<br>- 월 선택 드롭다운<br>  ㄴ 현재 월 기준 과거 3개월까지 선택 가능<br>  ㄴ 기본값: 현재 월<br>  ㄴ 예시: "2025년 11월", "2025년 10월", "2025년 9월"<br>- 기간 범위 선택<br>  ㄴ 시작일 / 종료일 직접 선택 (날짜 선택 UI)<br>  ㄴ 최대 조회 기간: 90일<br>  ㄴ 기본값: 당월 1일 ~ 말일<br>  ㄴ 미래 날짜까지 선택 가능 (예약 예정 건 조회)<br>  ㄴ 날짜 형식: YYYY.MM.DD<br><br>**4. 메시지 타입 필터**<br>- 메시지 타입 선택 드롭다운<br>  ㄴ 전체 (기본값)<br>  ㄴ SMS (단문)<br>  ㄴ LMS (장문)<br>  ㄴ MMS (이미지)<br>  ㄴ 알림톡<br>  ㄴ 브랜드톡<br>- 선택한 타입에 따라 목록 필터링<br><br>**5. 검색 기능**<br>- 검색어 입력창<br>  ㄴ 플레이스홀더: "제목 또는 내용을 입력해주세요"<br>  ㄴ 검색 대상: 메시지 제목, 메시지 내용<br>  ㄴ 부분 일치 검색 지원<br>- 검색 버튼<br>  ㄴ 클릭 시 입력된 조건으로 목록 조회<br>  ㄴ Enter 키 입력으로도 검색 실행<br><br>**6. 예약내역 목록**<br>- 테이블 형태로 예약내역 표시<br>- 컬럼 구성<br>  ㄴ **등록일**: 예약 등록 날짜 및 시간 (YYYY.MM.DD HH:MM)<br>  ㄴ **발송 예정일**: 발송 예약 날짜 및 시간 (YYYY.MM.DD HH:MM)<br>  ㄴ **제목/내용**: <br>    → 제목이 있는 경우 제목 표시 (최대 50자)<br>    → 제목이 없는 경우 내용 일부 표시 (최대 50자)<br>    → 말줄임(...) 처리<br>    → 클릭 시 상세보기 팝업 호출<br>  ㄴ **메시지 타입**: SMS/LMS/MMS/알림톡/브랜드톡<br>  ㄴ **예약 건 수**: 발송 예정 수신자 수<br>  ㄴ **예약 성공**: 예약 성공 건 수 (수신거부 등 제외 후 실제 발송 예정 건수)<br>  ㄴ **상태**: <br>    → "예약대기" (발송 예정)<br>    → "발송완료" (예약 시간 도래 후 발송 완료)<br>    → "취소됨" (사용자가 취소)<br>    → "실패" (시스템 오류 등)<br>  ㄴ **관리**: 액션 버튼<br>    → "상세보기" 버튼: 예약 상세 정보 팝업<br>    → "취소" 버튼: 예약 취소 (예약시간 10분 전까지만 표시)<br>    → "수정" 버튼: 예약 수정 기능 제거 (예약대기 상태에서 수정 불가)<br>- 정렬 기능<br>  ㄴ 기본 정렬: 발송 예정일 내림차순 (최신 예약 순)<br>  ㄴ 컬럼 헤더 클릭 시 오름차순/내림차순 정렬<br>- 페이징 처리<br>  ㄴ 페이지당 표시 건수: 10건/20건/50건/100건 선택 가능<br>  ㄴ 기본값: 20건<br>  ㄴ 페이지 네비게이션: 이전/다음, 페이지 번호<br>- 총 건수 표시<br>  ㄴ "총 N 건" 형태로 표시<br><br>**7. 데이터 없음 상태**<br>- 검색 결과가 없는 경우<br>  ㄴ "검색 결과가 없습니다." 메시지 표시<br>  ㄴ 검색 조건 재설정 안내<br>- 예약내역이 없는 경우<br>  ㄴ "예약된 메시지가 없습니다." 메시지 표시<br>  ㄴ "메시지 발송하기" 버튼 제공 → 문자발송 또는 카톡발송 페이지로 이동<br><br>**8. 예약 상세보기**<br>- "상세보기" 버튼 클릭 시 레이어 팝업 호출<br>- 상세 정보 표시<br>  ㄴ 발신번호<br>  ㄴ 수신번호 목록 (최대 100개 표시, 더보기 기능)<br>  ㄴ 메시지 타입<br>  ㄴ 메시지 제목 (있는 경우)<br>  ㄴ 메시지 전체 내용<br>  ㄴ 첨부 이미지 (MMS인 경우)<br>  ㄴ 등록일시<br>  ㄴ 예약 발송일시<br>  ㄴ 예약 건수 / 예약 성공 건수<br>  ㄴ 예상 발송 포인트<br>  ㄴ 상태<br>- 액션 버튼<br>  ㄴ "취소하기" 버튼 (예약시간 10분 전까지)<br>  ㄴ "닫기" 버튼<br>  ㄴ "수정하기" 버튼 제거<br><br>**9. 예약 수정**<br>- "수정" 버튼 클릭 시<br>  ㄴ 예약시간 10분 전까지만 수정 가능<br>  ㄴ 시간 경과 시 "수정 불가" 안내 메시지<br>- 수정 가능 항목<br>  ㄴ 수신번호 (추가/삭제)<br>  ㄴ 메시지 내용<br>  ㄴ 첨부 이미지 (MMS)<br>  ��� 예약 발송 시간<br>- 수정 불가 항목<br>  ㄴ 발신번호<br>  ㄴ 메시지 타입 (SMS/LMS/MMS 간 변경 불가)<br>- 수정 완료<br>  ㄴ 수정 확인 팝업<br>  ㄴ 수정 완료 안내 메시지<br>  ㄴ 예약내역 목록 새로고침<br><br>**10. 예약 취소**<br>- "취소" 버튼 클릭 시<br>  ㄴ 예약시간 10분 전까지만 취소 가능<br>  ㄴ 시간 경과 시 "취소 불가" 안내 메시지<br>- 취소 확인 팝업<br>  ㄴ "정말 취소하시겠습니까?" 확인 메시지<br>  ㄴ 취소 시 포인트 환불 여부 안내<br>  ㄴ "확인" / "취소" 버튼<br>- 취소 처리<br>  ㄴ 예약 상태를 "취소됨"으로 변경<br>  ㄴ 포인트 환불 처리 (설정에 따라)<br>  ㄴ 취소 완료 안내 메시지<br>  ㄴ 예약내역 목록 새로고침<br><br>**11. 일괄 작업**<br>- 체크박스 선택 기능<br>  ㄴ 목록의 각 항목에 체크박스 제공<br>  ㄴ 전체 선택 체크박스 (헤더)<br>- 선택 항목 일괄 취소<br>  ㄴ "선택 항목 취소" 버튼<br>  ㄴ 예약시간 10분 전인 항목만 취소 가능<br>  ㄴ 취소 불가능한 항목 제외 안내<br>  ㄴ 일괄 취소 확인 팝업<br>  ㄴ 취소 완료 안내 (성공 N건 / 실패 N건)<br><br>**12. 엑셀 다운로드**<br>- "엑셀 다운로드" 버튼<br>  ㄴ 현재 조회 조건의 예약내역을 엑셀 파일로 다운로드<br>  ㄴ 최대 다운로드 건수: 10,000건<br>- 다운로드 파일 정보<br>  ㄴ 파일명: 예약내역_YYYYMMDD_HHMMSS.xlsx<br>  ㄴ 포함 컬럼: 등록일, 발송예정일, 발신번호, 수신번호, 메시지타입, 제목, 내용, 예약건수, 예약성공, 상태<br><br>**13. 자동 새로고침**<br>- 페이지 활성화 상태에서 자동 새로고침<br>  ㄴ 30초마다 목록 자동 갱신<br>  ㄴ "발송중" 상태인 항목이 있을 경우에만 작동<br>  ㄴ 사용자가 검색/필터 조건 변경 시 자동 새로고침 일시 중지<br><br>**14. 알림 기능**<br>- 발송 임박 알림<br>  ㄴ 예약 발송 1시간 전 알림 (선택 사항)<br>  ㄴ 브라우저 알림 또는 이메일 알림<br>- 발송 완료 알림<br>  ㄴ 예약 발송 완료 시 알림<br>  ㄴ 발송 결과 요약 포함<br><br>**15. 연동 기능**<br>- "발송내역으로 이동" 링크<br>  ㄴ 예약이 완료되어 실제 발송된 내역은 발송내역 페이지에서 확인<br>  ㄴ 발송내역 페이지로 이동하는 링크 제공<br>- "메시지 발송하기" 버튼<br>  ㄴ 새로운 예약 발송을 위한 바로가기<br>  ㄴ 문자발송 또는 카톡발송 페이지로 이동<br><br>**16. 입력값 검증**<br>- 날짜 유효성 검증<br>  ㄴ 시작일이 종료일보다 늦은 경우 경고<br>  ㄴ 최대 조회 기간(90일) 초과 시 경고<br>- 검색어 길이 제한<br>  ㄴ 최소 2자 이상 입력 필요<br>  ㄴ 최대 100자 제한<br><br>**17. 오류 처리**<br>- 네트워크 오류<br>  ㄴ 목록 조회 실패 시 재시도 버튼 제공<br>  ㄴ "목록을 불러올 수 없습니다. 다시 시도해주세요."<br>- 취소/수정 실패<br>  ㄴ 실패 사유 안내<br>  ㄴ 재시도 옵션 제공<br>  ㄴ 고객센터 연락처 안내<br>- 시간 제한 오류<br>  ㄴ 예약시간 10분 전 경과 시<br>  ㄴ "예약시간이 임박하여 수정/취소가 불가능합니다."<br><br>**18. 성능 최적화**<br>- 대량 데이터 조회 시<br>  ㄴ 페이징 처리로 부하 분산<br>  ㄴ 로딩 인디케이터 표시<br>- 실시간 상태 업데이트<br>  ㄴ WebSocket 또는 폴링 방식으로 상태 변경 감지<br>  ㄴ 변경된 항목만 부분 업데이트<br><br>**19. 권한 관리**<br>- 본인이 등록한 예약내역만 조회 가능<br>- 기업 회원의 경우<br>  ㄴ 관리자: 전체 예약내역 조회 가능<br>  ㄴ 일반 사용자: 본인 예약내역만 조회<br><br>**20. 모바일 최적화**<br>- 반응형 디자인 적용<br>- 모바일에서 테이블 형태 대신 카드 형태로 표시<br>- 스와이프 제스처로 삭제/수정 기능 제공<br>- 터치 최적화된 버튼 크기 | SEND_REQ_001 | - 예약시간 10분 전까지만 수정/취소 가능<br>- 최근 90일 이내 내역만 조회 가능<br>- 예약 발송 시간 제한 준수 (광고문자의 경우 평일 08:00~21:00)<br>- 발송내역 페이지와 연동<br>- 실시간 상태 업데이트 필요 |
| 발송관리 | 발송관리 | 예약내역 | 상세보기 | - | layer popup | 발송관리 > 예약내역 > 상세보기 | SEND_2_3_1_0_0_LP | 공통 | 1차 | 로그인 | **1. 상세보기 레이어 팝업**<br>- "상세보기" 버튼 또는 제목/내용 클릭 시 호출<br>- 예약 발송 전체 정보 표시<br><br>**2. 기본 정보**<br>- 예약 ID (시스템 관리용)<br>- 등록일시: YYYY.MM.DD HH:MM:SS<br>- 발송 예정일시: YYYY.MM.DD HH:MM:SS<br>- 남은 시간 표시: "N시간 N분 후 발송 예정"<br>- 상태 뱃지: 예약대기/발송중/발송완료/취소됨/실패<br><br>**3. 발신 정보**<br>- 발신번호<br>- 080 수신거부 번호 (광고문자인 경우)<br><br>**4. 수신 정보**<br>- 총 예약 건수<br>- 예약 성공 건수 (실제 발송 예정)<br>- 수신거부로 제외된 건수<br>- 중복 제거된 건수<br>- 수신번호 목록<br>  ㄴ 최대 100개 표시<br>  ㄴ 100개 초과 시 "전체보기" 버튼<br>  ㄴ 전체보기 클릭 시 스크롤 가능한 전체 목록 표시<br>  ㄴ 수신번호 복사 기능<br><br>**5. 메시지 정보**<br>- 메시지 타입: SMS/LMS/MMS/알림톡/브랜드톡<br>- 메시지 제목 (있는 경우)<br>- 메시지 전체 내용<br>  ㄴ 원본 그대로 표시<br>  ㄴ 광고문자인 경우 (광고) 및 수신거부 문구 포함<br>- 첨부 이미지 (MMS인 경우)<br>  ㄴ 이미지 미리보기<br>  ㄴ 이미지 확대보기 기능<br>- 변수 치환 정보 (변수 사용 시)<br>  ㄴ 사용된 변수 목록<br>  ㄴ 변수별 치환 예시<br><br>**6. 비용 정보**<br>- 메시지 타입별 단가<br>- 총 예상 발송 비용<br>  ㄴ (예약 성공 건수) × (단가)<br>- 발송 시 차감될 포인트<br><br>**7. 메시지 미리보기**<br>- 실제 수신자가 받을 화면 형태로 표시<br>- 모바일 화면 UI로 렌더링<br>- 발신번호, 메시지 내용, 이미지 포함<br><br>**8. 액션 버튼**<br>- "수정하기" 버튼<br>  ㄴ 예약시간 10분 전까지만 활성화<br>  ㄴ 클릭 시 예약 수정 팝업 호출<br>- "취소하기" 버튼<br>  ㄴ 예약시간 10분 전까지만 활성화<br>  ㄴ 클릭 시 취소 확인 팝업 호출<br>- "복사하여 새로 보내기" 버튼<br>  ㄴ 동일한 내용으로 새 메시지 발송 페이지로 이동<br>  ㄴ 발신번호, 메시지 내용 자동 입력<br>- "닫기" 버튼<br>  ㄴ 팝업 닫기 | SEND_REQ_002 | - 수신번호가 많은 경우 성능 고려<br>- 이미지 로딩 최적화 |
| 발송관리 | 발송관리 | 예약내역 | 예약 수정 | - | layer popup | 발송관리 > 예약내역 > 예약 수정 | SEND_2_3_2_0_0_LP | 공통 | 1차 | 로그인 | **1. 예약 수정 레이어 팝업**<br>- 상세보기 또는 목록에서 "수정" 버튼 클릭 시 호출<br>- 예약시간 10분 전까지만 접근 가능<br><br>**2. 수정 가능 여부 확인**<br>- 예약 발송 시간까지 남은 시간 확인<br>  ㄴ 10분 이상 남은 경우: 수정 허용<br>  ㄴ 10분 미만 남은 경우: 수정 불가 안내<br>  ㄴ "예약 발송 시간이 임박하여 수정할 수 없습니다."<br><br>**3. 수정 가능 항목**<br>- **수신번호**<br>  ㄴ 기존 수신번호 목록 표시<br>  ㄴ 개별 번호 삭제 기능<br>  ㄴ 새 번호 추가<br>    → 직접 입력<br>    → 주소록에서 선택<br>    → 엑셀 업로드<br>  ㄴ 수신거부 번호 자동 제외<br>  ㄴ 중복 번호 자동 제거<br>- **메시지 내용**<br>  ㄴ 기존 내용 표시 및 편집 가능<br>  ㄴ 광고문자인 경우 (광고) 및 수신거부 문구는 자동 유지<br>  ㄴ 실시간 바이트 카운터<br>  ㄴ 메시지 타입 변경 제한 (SMS→LMS는 가능, LMS→SMS는 내용 초과 시 불가)<br>- **첨부 이미지** (MMS인 경우)<br>  ㄴ 기존 이미지 표시<br>  ㄴ 이미지 삭제<br>  ㄴ 새 이미지 업로드<br>- **예약 발송 시간**<br>  ㄴ 기존 예약 시간 표시<br>  ㄴ 날짜 및 시간 재선택<br>  ㄴ 현재 시각 이후만 선택 가능<br>  ㄴ 광고문자인 경우 발송 가능 시간 제한 적용<br><br>**4. 수정 불가 항목**<br>- 발신번호 (변경 불가)<br>- 메시지 타입 (SMS/LMS/MMS 간 자유 변경 불가)<br>  ㄴ 내용 길이에 따른 자동 변경만 허용<br><br>**5. 비용 재계산**<br>- 수신번호 변경 시 예상 비용 자동 재계산<br>- 변경 전/후 비용 비교 표시<br>- 추가 차감/환불 금액 표시<br><br>**6. 수정 확인**<br>- "수정하기" 버튼<br>  ㄴ 변경 사항 최종 확인 팝업<br>  ㄴ 변경 내역 요약 표시<br>  ㄴ 비용 변동 사항 안내<br>  ㄴ "확인" 클릭 시 수정 처리<br>- "취소" 버튼<br>  ㄴ 수정 취소 및 팝업 닫기<br><br>**7. 수정 처리**<br>- 예약 정보 업데이트<br>- 비용 정산 (추가 차감 또는 환불)<br>- 수정 완료 안내 메시지<br>- 예약내역 목록 자동 새로고침 | SEND_REQ_003 | - 수정 시 기존 예약은 취소되고 새 예약으로 대체<br>- 비용 정산 정책 명확히 안내 필요 |
| 발송관리 | 발송관리 | 예약내역 | 취소 확인 | - | layer popup | 발송관리 > 예약내역 > 취소 확인 | SEND_2_3_3_0_0_LP | 공통 | 1차 | 로그인 | **1. 취소 확인 모달 팝업**<br>- "취소" 버튼 클릭 시 호출<br>- 예약시간 10분 전까지만 접근 가능<br><br>**2. 취소 가능 여부 확인**<br>- 예약 발송 시간까지 남은 시간 확인<br>  ㄴ 10분 이상 남은 경우: 취소 허용<br>  ㄴ 10분 미만 남은 경우: 취소 불가 안내<br>  ㄴ "예약 발송 시간이 임박하여 취소할 수 없습니다."<br><br>**3. 취소 정보 표시**<br>- 취소할 예약 정보 요약<br>  ㄴ 발송 예정일시<br>  ㄴ 수신번호 개수<br>  ㄴ 메시지 타입<br>  ㄴ 메시지 내용 미리보기<br>
## 화면 흐름도

```
[예약내역 페이지 진입]
        ↓
[조회 조건 설정] → 월 선택 / 기간 선택 / 메시지 타입 / 검색어
        ↓
[예약내역 목록 조회]
        ↓
[목록 표시] ← 데이터 없음: "예약된 메시지가 없습니다"
        ↓
[항목 선택]
        ↓
    ┌───┴───┬───────┬───────┐
    ↓       ↓       ↓       ↓
[상세보기] [수정]  [취소]  [일괄작업]
    ↓       ↓       ↓       ↓
[상세정보] [수정팝업] [취소확인] [선택항목취소]
    ↓       ↓       ↓       ↓
[복사발송] [수정처리] [취소처리] [일괄취소처리]
    ↓       ↓       ↓       ↓
[새발송]   [완료]   [완료]   [완료]
    ↓       ↓       ↓       ↓
         [목록 새로고침]
```

## 주요 검증 사항

### 1. 시간 제약 검증
- 예약시간 10분 전 경과 여부 확인
- 수정/취소 가능 시간 실시간 체크
- 발송 임박 항목 비활성화 처리

### 2. 데이터 검증
- 조회 기간 유효성 (최대 90일)
- 수신번호 형식 검증
- 메시지 내용 길이 제한
- 중복 번호 처리

### 3. 비용 검증
- 예상 비용 정확성
- 수정 시 비용 재계산
- 취소 시 환불 금액 계산

### 4. 상태 관리
- 실시간 상태 업데이트
- 발송중 → 발송완료 전환
- 취소 처리 후 상태 반영

### 5. 권한 검증
- 본인 예약만 조회/수정/취소 가능
- 기업 회원 권한 레벨별 접근 제어

## 참고 사항

### 기술적 고려사항
- 실시간 상태 업데이트 (WebSocket 또는 30초 폴링)
- 대량 데이터 조회 시 페이징 성능
- 동시 수정/취소 요청 처리 (낙관적 잠금)
- 예약 발송 스케줄러 정확성

### 사용자 경험
- 명확한 시간 제약 안내
- 직관적인 상태 표시
- 빠른 검색 및 필터링
- 모바일 반응형 디자인

### 연동 페이지
- 발송내역 페이지 (발송 완료 건 조회)
- 문자발송 페이지 (새 예약 등록)
- 카톡발송 페이지 (새 예약 등록)
- 주소록 관리 페이지 (수신번호 선택)
- 충전하기 페이지 (잔액 부족 시)

### 법적/정책 고려사항
- 광고문자 발송 시간 제한 자동 적용
- 수신거부자 자동 제외
- 개인정보 보호 (수신번호 마스킹 옵션)
- 예약 취소 환불 정책 명시

### 모니터링 및 로그
- 예약 등록/수정/취소 이력 저장
- 발송 실패 원인 추적
- 시스템 오류 로그
- 사용자 행동 로그 (분석용)
