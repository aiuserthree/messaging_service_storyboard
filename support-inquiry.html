<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1:1 문의 - 톡벨</title>
    <script src="js/header.js"></script>
    <link rel="stylesheet" href="css/common.css">
    <style>
        .page-header {
            margin-bottom: 32px;
        }

        .page-header h2 {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        /* 탭 메뉴 */
        .support-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .support-tab {
            padding: 14px 24px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: var(--text-secondary);
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }

        .support-tab:hover {
            color: var(--text-primary);
        }

        .support-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        /* 문의 탭 */
        .inquiry-tabs {
            display: flex;
            gap: 0;
            margin-bottom: 24px;
            background-color: #f1f5f9;
            border-radius: var(--radius-md);
            padding: 4px;
        }

        .inquiry-tab {
            flex: none;
            padding: 12px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            transition: all 0.2s;
            border-radius: var(--radius-md);
        }

        .inquiry-tab.active {
            background-color: var(--surface-color);
            color: var(--primary-color);
        }

        /* 폼 스타일 */
        .inquiry-form {
            background-color: var(--surface-color);
            border-radius: var(--radius-xl);
            padding: 32px;
            border: 1px solid var(--border-color);
        }

        .form-row {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
        }

        .form-group {
            flex: 1;
            margin-bottom: 20px;
        }

        .form-group.full-width {
            width: 100%;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-label.required::after {
            content: ' *';
            color: var(--danger-color);
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 12px 16px;
            font-size: 14px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background-color: var(--surface-color);
            color: var(--text-primary);
            transition: all 0.2s;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 200px;
        }

        .email-input-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .email-input-group input#emailId {
            flex: 1;
            min-width: 0;
        }

        .email-input-group input#emailDomain {
            flex: 1;
            min-width: 0;
        }

        .email-input-group select {
            flex: 1;
            min-width: 0;
        }

        .email-input-group span {
            color: var(--text-secondary);
            flex-shrink: 0;
        }

        .file-input-group {
            display: flex;
            gap: 8px;
        }

        .file-input-group input {
            flex: 1;
        }

        .file-info {
            margin-top: 8px;
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .privacy-agreement {
            margin-top: 24px;
            padding: 20px;
            background-color: var(--bg-color);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-color);
        }

        .privacy-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 16px;
        }

        .privacy-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-top: 2px;
            cursor: pointer;
        }

        .privacy-checkbox label {
            font-size: 14px;
            color: var(--text-primary);
            cursor: pointer;
        }

        .privacy-details {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.8;
            padding-left: 26px;
        }

        .form-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 32px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius-md);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-reset {
            background-color: #f59e0b;
            color: white;
        }

        .btn-reset:hover {
            background-color: #d97706;
        }

        .btn-submit {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-submit:hover {
            background-color: var(--primary-hover);
        }

        /* 문의내역 테이블 */
        .inquiry-table-container {
            background-color: var(--surface-color);
            border-radius: var(--radius-xl);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th,
        .table td {
            padding: 14px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .table th {
            background-color: #f8fafc;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 13px;
        }

        .table tbody tr:last-child td {
            border-bottom: none;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }
        /* 환불신청/환불신청내역 패널 */
        .balance-summary { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 24px; }
        .balance-card { background: var(--surface-color); border: 1px solid var(--border-color); border-radius: var(--radius-xl); padding: 20px; text-align: center; }
        .balance-card.highlight { background: rgba(37, 99, 235, 0.08); border-color: var(--primary-color); }
        .balance-card-label { font-size: 13px; color: var(--text-secondary); margin-bottom: 6px; }
        .balance-card-value { font-size: 22px; font-weight: 700; color: var(--text-primary); }
        .calc-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--border-color); }
        .calc-row.total { border-bottom: none; font-weight: 600; margin-top: 8px; }
        .file-upload-wrap { border: 2px dashed var(--border-color); border-radius: var(--radius-md); padding: 24px; text-align: center; background: var(--bg-color); }
        .file-upload-wrap input[type="file"] { display: none; }
        .file-upload-wrap label { cursor: pointer; color: var(--primary-color); font-weight: 500; }
        .terms-box { background: var(--bg-color); border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 16px; margin: 12px 0; max-height: 120px; overflow-y: auto; font-size: 12px; color: var(--text-secondary); line-height: 1.6; }
        .agree-row { display: flex; align-items: flex-start; gap: 10px; margin: 16px 0; }
        .agree-row input[type="checkbox"] { margin-top: 4px; }
        .card { background: var(--surface-color); border: 1px solid var(--border-color); border-radius: 12px; padding: 24px; margin-bottom: 24px; }
        .card-title { font-size: 18px; font-weight: 600; margin-bottom: 16px; }
        .table-container { overflow-x: auto; }
        @media (max-width: 768px) { .balance-summary { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="app-container">
        <script>
            document.write(createHeader('support'));
        </script>

        <main class="main-content">
            <div class="page-header">
                <h2>고객센터</h2>
                <p class="page-description">궁금하신 점이나 문의사항을 남겨주시면 빠르게 답변드리겠습니다.</p>
            </div>

            <!-- 서브 메인: 탭에서 선택 시 해당 페이지로 이동 -->
            <div class="support-tabs" id="supportTabs">
                <a href="support-notice.html" class="support-tab">공지사항</a>
                <a href="support-faq.html" class="support-tab">FAQ</a>
                <a href="support-inquiry.html" class="support-tab active">1:1 문의</a>
            </div>

            <!-- 문의 탭 -->
            <div class="inquiry-tabs" id="inquiryTabs">
                <button class="inquiry-tab active" id="inquiryFormTab" onclick="switchInquiryTab('form')">1:1 문의하기</button>
                <button class="inquiry-tab" id="inquiryHistoryTab" onclick="switchInquiryTab('history')">1:1 문의내역</button>
                <button class="inquiry-tab" id="inquiryRefundTab" onclick="switchInquiryTab('refund')">환불신청</button>
                <button class="inquiry-tab" id="inquiryRefundHistoryTab" onclick="switchInquiryTab('refundHistory')">환불신청내역</button>
            </div>

            <!-- 1:1 문의하기 -->
            <div id="inquiryForm" class="inquiry-tab-content">
                <div class="inquiry-form" id="inquiryFormWrapper">
                    <form id="inquiryFormElement" onsubmit="handleSubmit(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="userId">아이디</label>
                                <input 
                                    type="text" 
                                    id="userId" 
                                    class="form-input" 
                                    value="jhcho5784"
                                    readonly
                                >
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="email">이메일</label>
                                <div class="email-input-group">
                                    <input 
                                        type="text" 
                                        id="emailId" 
                                        class="form-input" 
                                        value="jhcho5784"
                                    >
                                    <span>@</span>
                                    <input 
                                        type="text" 
                                        id="emailDomain" 
                                        class="form-input" 
                                        value="naver.com"
                                    >
                                    <select class="form-select" id="emailDomainSelect" onchange="handleEmailDomainChange()">
                                        <option value="naver.com" selected>네이버</option>
                                        <option value="gmail.com">Gmail</option>
                                        <option value="daum.net">다음</option>
                                        <option value="custom">직접입력</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label required" for="inquiryType">문의유형</label>
                                <select class="form-select" id="inquiryType" required>
                                    <option value="">문의유형 선택</option>
                                    <option value="price">가격 문의</option>
                                    <option value="service">서비스 문의</option>
                                    <option value="technical">기술 문의</option>
                                    <option value="other">기타</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group full-width">
                                <label class="form-label required" for="subject">제목</label>
                                <input 
                                    type="text" 
                                    id="subject" 
                                    class="form-input" 
                                    placeholder="제목을 입력해주세요"
                                    required
                                >
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group full-width">
                                <label class="form-label required" for="content">문의내용</label>
                                <textarea 
                                    id="content" 
                                    class="form-textarea" 
                                    placeholder="문의 내용을 입력해주세요"
                                    required
                                ></textarea>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group full-width">
                                <label class="form-label" for="attachment">첨부파일</label>
                                <div class="file-input-group">
                                    <input 
                                        type="text" 
                                        id="filePath" 
                                        class="form-input" 
                                        placeholder="파일을 선택해주세요"
                                        readonly
                                    >
                                    <button type="button" class="btn btn-outline" onclick="document.getElementById('fileInput').click()">찾아보기</button>
                                    <input 
                                        type="file" 
                                        id="fileInput" 
                                        style="display: none;"
                                        onchange="handleFileSelect(event)"
                                        accept=".jpg,.jpeg,.gif,.png,.bmp,.docx,.xlsx,.xls,.csv,.pdf"
                                    >
                                </div>
                                <div class="file-info">
                                    • 5MB 이하의 파일만 업로드 가능합니다.<br>
                                    • 첨부 가능한 파일 형식 : jpg, jpeg, gif, png, bmp, docx, xlsx, xls, csv, pdf
                                </div>
                            </div>
                        </div>

                        <div class="privacy-agreement">
                            <div class="privacy-checkbox">
                                <input type="checkbox" id="privacyAgree" required>
                                <label for="privacyAgree">개인정보 수집 및 이용에 동의합니다. (필수)</label>
                            </div>
                            <div class="privacy-details">
                                - 수집 및 이용 항목 : 아이디, 이메일, 첨부파일<br>
                                - 수집 및 이용 목적: 문의 접수 및 답변 회신<br>
                                - 수집 및 이용 기간 : 개인정보처리방침 준수, 관계법령 및 기타응대를 위해 문의 내용을 보관할 수 있습니다.
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-reset" onclick="handleReset()">다시쓰기</button>
                            <button type="submit" class="btn btn-submit">문의하기</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- 1:1 문의내역 -->
            <div id="inquiryHistory" class="inquiry-tab-content" style="display: none;">
                <div class="inquiry-table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th style="width: 80px;">번호</th>
                                <th style="width: 150px;">문의유형</th>
                                <th>제목</th>
                                <th style="width: 100px;">답변여부</th>
                                <th style="width: 120px;">등록일</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="5">
                                    <div class="empty-state">문의하신 내역이 없습니다.</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 환불신청 (본문만) -->
            <div id="inquiryRefund" class="inquiry-tab-content" style="display: none;">
                <div class="balance-summary" id="refundBalanceSummary" data-remaining-points="1000000">
                    <div class="balance-card highlight">
                        <div class="balance-card-label">잔여 포인트</div>
                        <div class="balance-card-value" id="refundRemainingPoints">1,000,000 P</div>
                    </div>
                    <div class="balance-card">
                        <div class="balance-card-label">환불 금액 (수수료 10% 차감 후)</div>
                        <div class="balance-card-value" id="refundableAmount">900,000 P</div>
                        <div class="balance-card-label" style="font-size: 12px; margin-top: 4px;">잔여 포인트 전액 환불</div>
                    </div>
                    <div class="balance-card">
                        <div class="balance-card-label">마일리지</div>
                        <div class="balance-card-value" id="refundMileage">92.6</div>
                        <div class="balance-card-label" style="font-size: 12px; margin-top: 4px;">환불 불가</div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title" style="margin-bottom: 20px;">환불 신청</h3>
                    <p class="form-help" style="margin-bottom: 20px;">잔여 포인트 전액이 환불됩니다. 수수료 10% 차감 후 금액이 계좌로 입금됩니다.</p>
                    <div class="calc-row"><span>환불 대상 (잔여 포인트 전액)</span><span id="refundTargetDisplay">1,000,000 P</span></div>
                    <div class="calc-row"><span>환불 수수료 (10%)</span><span id="refundFeeDisplay">-100,000 P</span></div>
                    <div class="calc-row total"><span>실제 환불 금액</span><span id="refundFinalDisplay">900,000 P</span></div>
                    <div class="form-group" style="margin-top: 24px;">
                        <label class="form-label required">환불 받을 계좌 정보</label>
                        <div class="form-group" style="margin-bottom: 12px;">
                            <select class="form-select" id="refundBank">
                                <option value="">은행 선택</option>
                                <option value="kb">KB국민은행</option>
                                <option value="shinhan">신한은행</option>
                                <option value="woori">우리은행</option>
                                <option value="hana">하나은행</option>
                                <option value="nh">NH농협은행</option>
                                <option value="kakao">카카오뱅크</option>
                                <option value="kbank">케이뱅크</option>
                                <option value="toss">토스뱅크</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin-bottom: 12px;">
                            <input type="text" class="form-input" id="refundAccountNumber" placeholder="계좌번호 ('-' 없이 숫자만)">
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-input" id="refundAccountHolder" placeholder="예금주명">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label required">통장사본</label>
                        <div class="file-upload-wrap">
                            <input type="file" id="refundBankCopy" accept="image/*,.pdf" onchange="handleBankCopy(this)">
                            <label for="refundBankCopy" id="refundBankCopyLabel">파일 선택 (이미지 또는 PDF)</label>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-top: 8px;">환불 받을 계좌의 통장사본을 업로드해 주세요</div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">환불 사유 (선택)</label>
                        <textarea class="form-textarea" id="refundReasonText" placeholder="환불 사유를 입력해 주세요" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label required">개인정보수집·이용 동의</label>
                        <div class="terms-box">
                            환불 신청 및 처리와 관련하여 아래와 같이 개인정보를 수집·이용합니다.<br>
                            • 수집 항목: 성명, 연락처, 계좌정보(은행명, 계좌번호, 예금주)<br>
                            • 수집·이용 목적: 환불 신청 접수 및 환불금 지급<br>
                            • 보유·이용 기간: 환불 처리 완료 후 5년 (전자상거래 등에서의 소비자 보호에 관한 법률)<br>
                            • 동의 거부 시: 환불 신청이 불가할 수 있습니다.
                        </div>
                        <div class="agree-row">
                            <input type="checkbox" id="refundPrivacyAgree" name="refundPrivacyAgree">
                            <label for="refundPrivacyAgree">개인정보 수집·이용에 동의합니다</label>
                        </div>
                    </div>
                    <button type="button" class="btn btn-danger btn-lg" style="width: 100%;" onclick="submitRefundApply()">환불 신청하기</button>
                </div>
            </div>

            <!-- 환불신청내역 (본문만) -->
            <div id="inquiryRefundHistory" class="inquiry-tab-content" style="display: none;">
                <div class="card">
                    <h3 class="card-title" style="margin-bottom: 20px;">환불 신청 내역</h3>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>신청일</th>
                                    <th>환불금액</th>
                                    <th>상태</th>
                                    <th>처리일</th>
                                    <th>비고</th>
                                </tr>
                            </thead>
                            <tbody id="refundHistoryBody">
                                <tr>
                                    <td>2024-11-20 14:30</td>
                                    <td>90,000 P</td>
                                    <td><span class="badge badge-success">환불완료</span></td>
                                    <td>2024-11-22</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>2024-11-15 10:00</td>
                                    <td>50,000 P</td>
                                    <td><span class="badge badge-warning">처리중</span></td>
                                    <td>-</td>
                                    <td>영업일 기준 7일 이내</td>
                                </tr>
                                <tr>
                                    <td>2024-11-01 09:00</td>
                                    <td>200,000 P</td>
                                    <td><span class="badge badge-danger">반려</span></td>
                                    <td>2024-11-02</td>
                                    <td>계좌정보 불일치</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        function switchInquiryTab(tab) {
            const tabs = ['inquiryFormTab', 'inquiryHistoryTab', 'inquiryRefundTab', 'inquiryRefundHistoryTab'];
            const panels = ['inquiryForm', 'inquiryHistory', 'inquiryRefund', 'inquiryRefundHistory'];
            tabs.forEach(function(id, i) {
                var el = document.getElementById(id);
                if (el) el.classList.toggle('active', (tab === 'form' && id === 'inquiryFormTab') || (tab === 'history' && id === 'inquiryHistoryTab') || (tab === 'refund' && id === 'inquiryRefundTab') || (tab === 'refundHistory' && id === 'inquiryRefundHistoryTab'));
            });
            panels.forEach(function(id) {
                var el = document.getElementById(id);
                if (el) el.style.display = (id === 'inquiryForm' && tab === 'form') || (id === 'inquiryHistory' && tab === 'history') || (id === 'inquiryRefund' && tab === 'refund') || (id === 'inquiryRefundHistory' && tab === 'refundHistory') ? 'block' : 'none';
            });
        }

        function handleEmailDomainChange() {
            const select = document.getElementById('emailDomainSelect');
            const domainInput = document.getElementById('emailDomain');
            
            if (select.value === 'custom') {
                domainInput.value = '';
                domainInput.readOnly = false;
                domainInput.focus();
            } else {
                domainInput.value = select.value;
                domainInput.readOnly = true;
            }
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                const filePath = document.getElementById('filePath');
                filePath.value = file.name;
                
                // 파일 크기 체크 (5MB)
                if (file.size > 5 * 1024 * 1024) {
                    alert('5MB 이하의 파일만 업로드 가능합니다.');
                    event.target.value = '';
                    filePath.value = '';
                    return;
                }
            }
        }

        function handleReset() {
            document.getElementById('inquiryFormElement').reset();
            document.getElementById('userId').value = 'jhcho5784';
            document.getElementById('emailId').value = 'jhcho5784';
            document.getElementById('emailDomain').value = 'naver.com';
            document.getElementById('emailDomainSelect').value = 'naver.com';
            document.getElementById('filePath').value = '';
            document.getElementById('fileInput').value = '';
        }

        function handleSubmit(event) {
            event.preventDefault();
            
            if (!document.getElementById('privacyAgree').checked) {
                alert('개인정보 수집 및 이용에 동의해주세요.');
                return;
            }

            // 폼 제출 로직
            alert('문의가 접수되었습니다. 빠른 시일 내에 답변드리겠습니다.');
            handleReset();
        }

        function updateRefundCalc() {
            var el = document.getElementById('refundBalanceSummary');
            if (!el) return;
            var remaining = parseInt(el.getAttribute('data-remaining-points'), 10) || 0;
            if (remaining < 0) remaining = 0;
            var fee = Math.floor(remaining * 0.1);
            var finalAmount = remaining - fee;
            var a = document.getElementById('refundTargetDisplay');
            var b = document.getElementById('refundFeeDisplay');
            var c = document.getElementById('refundFinalDisplay');
            var d = document.getElementById('refundRemainingPoints');
            var e = document.getElementById('refundableAmount');
            if (a) a.textContent = (remaining).toLocaleString() + ' P';
            if (b) b.textContent = '-' + (fee).toLocaleString() + ' P';
            if (c) c.textContent = (finalAmount).toLocaleString() + ' P';
            if (d) d.textContent = (remaining).toLocaleString() + ' P';
            if (e) e.textContent = (finalAmount).toLocaleString() + ' P';
        }
        function handleBankCopy(input) {
            var label = document.getElementById('refundBankCopyLabel');
            if (label) label.textContent = (input.files && input.files.length) ? input.files[0].name : '파일 선택 (이미지 또는 PDF)';
        }
        function submitRefundApply() {
            var el = document.getElementById('refundBalanceSummary');
            var remaining = el ? parseInt(el.getAttribute('data-remaining-points'), 10) || 0 : 0;
            var bank = document.getElementById('refundBank');
            var account = document.getElementById('refundAccountNumber');
            var holder = document.getElementById('refundAccountHolder');
            var file = document.getElementById('refundBankCopy');
            var agree = document.getElementById('refundPrivacyAgree');
            if (remaining <= 0) { alert('환불할 잔여 포인트가 없습니다.'); return; }
            if (!bank || !bank.value) { alert('은행을 선택해 주세요.'); return; }
            if (!account || !account.value || !holder || !holder.value) { alert('계좌번호와 예금주를 입력해 주세요.'); return; }
            if (!file || !file.files || file.files.length === 0) { alert('통장사본을 업로드해 주세요.'); return; }
            if (!agree || !agree.checked) { alert('개인정보 수집·이용에 동의해 주세요.'); return; }
            if (!confirm('환불을 신청하시겠습니까?\n영업일 기준 7일 이내에 처리됩니다.')) return;
            var fee = Math.floor(remaining * 0.1);
            var finalAmount = remaining - fee;
            window.location.href = 'payment-refund-complete.html?target=' + remaining + '&amount=' + finalAmount;
        }

        // URL 해시에 따라 탭 표시
        function applyInquiryTabFromHash() {
            var hash = (window.location.hash || '#form').replace('#', '');
            if (hash === 'history') switchInquiryTab('history');
            else if (hash === 'refund') switchInquiryTab('refund');
            else if (hash === 'refundHistory') switchInquiryTab('refundHistory');
            else switchInquiryTab('form');
        }

        document.addEventListener('DOMContentLoaded', function() {
            if (typeof initDropdownMenus === 'function') initDropdownMenus();
            applyInquiryTabFromHash();
            updateRefundCalc();
        });
        window.addEventListener('hashchange', applyInquiryTabFromHash);
    </script>

    <script src="js/footer.js"></script>
    <script>
        document.write(createFloatingMenu());
        document.write(createFooter());
    </script>
    <!-- 화면설계 오버레이 -->
    <script src="js/spec-overlay.js"></script>
    <script>
        const specData = [
            // ===== 페이지 기본 요소 =====
            // 1-5. 탭 메뉴
            { selector: '#supportTabs', title: '탭 메뉴', position: { top: '-10px', left: '10px' }, description: '고객센터 탭 영역', function: '고객센터 페이지 전환' },
            { selector: '#supportTabs .support-tab:nth-child(1)', title: '공지사항 탭', position: { top: '-5px', left: '-10px' }, description: '공지사항 페이지', function: '클릭 시 support-notice.html로 이동' },
            { selector: '#supportTabs .support-tab:nth-child(2)', title: '이벤트 탭', position: { top: '-5px', left: '-10px' }, description: '이벤트 페이지', function: '클릭 시 support-event.html로 이동' },
            { selector: '#supportTabs .support-tab:nth-child(3)', title: 'FAQ 탭', position: { top: '-5px', left: '-10px' }, description: 'FAQ 페이지', function: '클릭 시 support-faq.html로 이동' },
            { selector: '#supportTabs .support-tab:nth-child(4)', title: '1:1 문의 탭', position: { top: '-5px', right: '-10px' }, description: '1:1 문의 페이지 (현재)', function: '현재 페이지', behavior: ['현재 활성 탭'] },
            // 6-10. 문의 탭 메뉴
            { selector: '#inquiryTabs', title: '문의 탭 메뉴', position: { top: '-5px', left: '-10px' }, description: '문의하기/문의내역/환불신청/환불신청내역 전환', function: '하위 탭 전환' },
            { selector: '#inquiryFormTab', title: '1:1 문의하기 탭', position: { top: '-5px', left: '-10px' }, description: '새 문의 작성', function: "switchInquiryTab('form') 호출", behavior: ['클릭 시 문의 작성 폼 표시', '현재 활성화 상태 표시'] },
            { selector: '#inquiryHistoryTab', title: '1:1 문의내역 탭', position: { top: '-5px', left: '-10px' }, description: '이전 문의 내역 조회', function: "switchInquiryTab('history') 호출", behavior: ['클릭 시 문의 내역 테이블 표시'], api: 'GET /api/inquiries' },
            { selector: '#inquiryRefundTab', title: '환불신청 탭', position: { top: '-5px', left: '-10px' }, description: '포인트 환불 신청', function: "switchInquiryTab('refund') 호출", behavior: ['클릭 시 환불신청 패널 표시(잔여 포인트·환불 금액·계좌 정보·통장사본·환불 신청하기)'] },
            { selector: '#inquiryRefundHistoryTab', title: '환불신청내역 탭', position: { top: '-5px', right: '-10px' }, description: '환불 신청 내역 조회', function: "switchInquiryTab('refundHistory') 호출", behavior: ['클릭 시 환불 신청 내역 테이블 표시'], api: 'GET /api/refund-requests' },
            
            // ===== 1:1 문의하기 폼 =====
            // 9. 문의 폼 영역
            { selector: '#inquiryFormWrapper', title: '1:1 문의 폼', position: { top: '10px', left: '10px' }, description: '문의 작성 양식', function: '문의 정보 입력' },
            // 10. 아이디 필드
            { selector: '#userId', title: '아이디', position: { top: '-5px', right: '-10px' }, description: '로그인 아이디 (읽기전용)', function: '자동 입력 (수정 불가)', behavior: ['로그인 사용자 아이디 자동 표시'] },
            // 11-13. 이메일 필드
            { selector: '#emailId', title: '이메일 아이디', position: { top: '-5px', left: '-10px' }, description: '이메일 @ 앞부분', function: '이메일 ID 입력' },
            { selector: '#emailDomain', title: '이메일 도메인 입력', position: { top: '-5px', left: '-10px' }, description: '이메일 @ 뒷부분', function: '도메인 직접 입력 (직접입력 선택 시)' },
            { selector: '#emailDomainSelect', title: '이메일 도메인 선택', position: { top: '-5px', right: '-10px' }, description: '이메일 도메인 선택', function: 'handleEmailDomainChange() 호출', behavior: ['네이버/Gmail/다음/직접입력 선택', '직접입력 시 도메인 입력 활성화'] },
            // 14. 문의유형 선택
            { selector: '#inquiryType', title: '문의유형 선택', position: { top: '-5px', left: '-10px' }, description: '문의 카테고리', function: '문의 유형 선택', behavior: ['가격문의/서비스문의/기술문의/기타'], tags: [{ text: '필수', type: 'required' }] },
            // 15. 제목 입력
            { selector: '#subject', title: '제목 입력', position: { top: '-5px', right: '-10px' }, description: '문의 제목', function: '제목 입력', tags: [{ text: '필수', type: 'required' }] },
            // 16. 내용 입력
            { selector: '#content', title: '문의내용 입력', position: { top: '5px', right: '5px' }, description: '문의 내용 작성', function: '상세 내용 입력', behavior: ['충분한 내용 입력 권장'], tags: [{ text: '필수', type: 'required' }] },
            // 17-18. 파일 첨부
            { selector: '#filePath', title: '파일 경로 표시', position: { top: '-5px', left: '-10px' }, description: '선택된 파일명 표시', function: '읽기전용 파일명 표시' },
            { selector: '.file-input-group .btn-outline', title: '찾아보기 버튼', position: { top: '-5px', right: '-10px' }, description: '파일 선택', function: 'fileInput 클릭 트리거', behavior: ['파일 선택 다이얼로그 열기', '5MB 이하 파일만 가능', 'jpg, png, pdf 등 지원'] },
            // 19. 개인정보 동의
            { selector: '#privacyAgree', title: '개인정보 동의 체크', position: { top: '-5px', left: '-10px' }, description: '개인정보 수집 동의', function: '체크박스 선택', behavior: ['필수 체크', '미체크 시 제출 불가'], tags: [{ text: '필수', type: 'required' }] },
            // 20-21. 폼 버튼
            { selector: '.btn-reset', title: '다시쓰기 버튼', position: { top: '-5px', left: '-10px' }, description: '폼 초기화', function: 'handleReset() 호출', behavior: ['모든 입력 내용 초기화', '기본값 복원'] },
            // 문의하기 버튼
            {
                selector: '.btn-submit',
                title: '문의하기 버튼',
                position: { top: '-5px', right: '-10px' },
                description: '버튼 (Button - Primary)',
                function: '1:1 문의 등록',
                behavior: [
                    '【유효성 검사】',
                    '• 이메일 입력 필수',
                    '• 문의유형 선택 필수',
                    '• 제목 입력 필수',
                    '• 문의내용 입력 필수',
                    '• 개인정보 수집 동의 체크 필수',
                    '【Alert 메시지 - 유효성 실패】',
                    '• 이메일 미입력: "이메일을 입력해주세요."',
                    '• 이메일 형식 오류: "올바른 이메일 형식이 아닙니다."',
                    '• 문의유형 미선택: "문의유형을 선택해주세요."',
                    '• 제목 미입력: "제목을 입력해주세요."',
                    '• 내용 미입력: "문의내용을 입력해주세요."',
                    '• 동의 미체크: "개인정보 수집 및 이용에 동의해주세요."',
                    '【Toast 메시지】',
                    '• 등록 성공: "문의가 등록되었습니다. 빠른 시일 내 답변드리겠습니다."',
                    '• 등록 실패: "문의 등록에 실패했습니다."',
                    '【동작】',
                    '• 성공 시 폼 초기화 및 문의내역 탭으로 이동',
                    '【Alert 메시지 - 시스템 에러】',
                    '• 서버 오류: "서버 오류가 발생했습니다."',
                    '• 세션 만료: "로그인이 만료되었습니다."'
                ],
                api: 'POST /api/inquiries'
            },
            
            // ===== 1:1 문의내역 =====
            // 22. 문의 내역 영역
            { selector: '#inquiryHistory', title: '문의 내역 영역', position: { top: '10px', left: '10px' }, description: '이전 문의 목록', function: '문의 내역 테이블 표시', api: 'GET /api/inquiries' },
            // 23. 문의 내역 테이블
            { selector: '#inquiryHistory .table', title: '문의 내역 테이블', position: { top: '10px', left: '10px' }, description: '문의 목록 표시', function: '번호/문의유형/제목/답변여부/등록일 표시', behavior: ['행 클릭 시 상세 내용 확인 가능'] },

            // ===== 환불신청 =====
            // 24. 환불신청 패널
            { selector: '#inquiryRefund', title: '환불신청 패널', position: { top: '10px', left: '10px' }, description: '포인트 환불 신청 영역', function: '잔여 포인트·환불 금액 표시 및 계좌 정보 입력 후 환불 신청', behavior: ['환불신청 탭 선택 시 표시', '잔여 포인트 전액 환불, 수수료 10% 차감 후 실 환불금 입금'] },
            { selector: '#refundBalanceSummary', title: '환불 잔액 요약', position: { top: '5px', left: '10px' }, description: '잔여 포인트·환불 금액·마일리지 카드', function: '잔여 포인트, 환불 금액(수수료 10% 차감 후), 마일리지(환불 불가) 표시', behavior: ['data-remaining-points 기반 계산'] },
            { selector: '#refundRemainingPoints', title: '잔여 포인트', position: { top: '-5px', right: '-10px' }, description: '현재 보유 포인트', function: '잔여 포인트 표시' },
            { selector: '#refundableAmount', title: '환불 금액', position: { top: '-5px', right: '-10px' }, description: '수수료 차감 후 실 환불 예정 금액', function: '환불 금액(10% 수수료 차감 후) 표시' },
            { selector: '#refundTargetDisplay', title: '환불 대상', position: { top: '-5px', right: '-10px' }, description: '환불 계산 행', function: '잔여 포인트 전액 표시' },
            { selector: '#refundFeeDisplay', title: '환불 수수료', position: { top: '-5px', right: '-10px' }, description: '10% 수수료 금액', function: '차감 수수료 표시' },
            { selector: '#refundFinalDisplay', title: '실제 환불 금액', position: { top: '-5px', right: '-10px' }, description: '최종 환불 금액', function: '실제 환불 금액 표시' },
            { selector: '#refundBank', title: '은행 선택', position: { top: '-5px', left: '-10px' }, description: '환불 받을 계좌 은행', function: '은행 선택 (필수)', tags: [{ text: '필수', type: 'required' }] },
            { selector: '#refundAccountNumber', title: '계좌번호', position: { top: '-5px', left: '-10px' }, description: "'-' 없이 숫자만 입력", function: '계좌번호 입력', tags: [{ text: '필수', type: 'required' }] },
            { selector: '#refundAccountHolder', title: '예금주명', position: { top: '-5px', left: '-10px' }, description: '예금주 이름', function: '예금주명 입력', tags: [{ text: '필수', type: 'required' }] },
            { selector: '#refundBankCopy', title: '통장사본', position: { top: '-5px', left: '-10px' }, description: '이미지 또는 PDF 업로드', function: '통장사본 파일 첨부', behavior: ['환불 받을 계좌 확인용'], tags: [{ text: '필수', type: 'required' }] },
            { selector: '#refundReasonText', title: '환불 사유', position: { top: '-5px', left: '-10px' }, description: '선택 입력', function: '환불 사유 입력 (선택)' },
            { selector: '#refundPrivacyAgree', title: '개인정보 수집·이용 동의', position: { top: '-5px', left: '-10px' }, description: '환불 처리용 개인정보 동의', function: '체크박스 선택', behavior: ['미체크 시 환불 신청 불가'], tags: [{ text: '필수', type: 'required' }] },
            { selector: '#inquiryRefund button[onclick="submitRefundApply()"]', title: '환불 신청하기 버튼', position: { top: '-5px', right: '-10px' }, description: '환불 신청 제출', function: 'submitRefundApply() 호출', behavior: ['계좌 정보·통장사본·개인정보 동의 필수', '유효성 검사 후 환불 완료 페이지로 이동'], api: 'POST /api/refund-requests' },

            // ===== 환불신청내역 =====
            // 25. 환불신청내역 패널
            { selector: '#inquiryRefundHistory', title: '환불신청내역 패널', position: { top: '10px', left: '10px' }, description: '환불 신청 내역 조회 영역', function: '과거 환불 신청 목록 표시', behavior: ['환불신청내역 탭 선택 시 표시'], api: 'GET /api/refund-requests' },
            { selector: '#inquiryRefundHistory .card-title', title: '환불 신청 내역 제목', position: { top: '-5px', left: '-10px' }, description: '섹션 제목', function: '환불 신청 내역 표시' },
            { selector: '#inquiryRefundHistory .table', title: '환불 신청 내역 테이블', position: { top: '10px', left: '10px' }, description: '환불 신청 목록', function: '신청일/환불금액/상태/처리일/비고 표시', behavior: ['【상태 항목】 환불완료(녹색), 처리중(노란색), 반려(빨간색)'] },
            { selector: '#refundHistoryBody', title: '환불 내역 테이블 본문', position: { top: '10px', left: '10px' }, description: '환불 신청 행 목록', function: '각 신청 건별 신청일·금액·상태·처리일·비고 표시' }
        ];
        initSpecOverlay(specData);
    </script>
</body>
</html>

